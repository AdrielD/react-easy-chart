{"version":3,"sources":["../../modules/line-chart/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport {createElement} from 'react-faux-dom';\nimport {reduce, calcMargin, getValueFunction, getRandomId, setLineDomainAndRange, defaultStyle, getAxisStyles, createCircularTicks, rmaColorPalet} from '../shared';\nimport {select, svg, time, event as d3LastEvent} from 'd3';\nimport {Style} from 'radium';\nimport merge from 'lodash.merge';\nimport {format} from 'd3-time-format';\n\nexport default class LineChart extends React.Component {\n  static get propTypes() {\n    return {\n      data: React.PropTypes.array.isRequired,\n      width: React.PropTypes.number,\n      height: React.PropTypes.number,\n      xType: React.PropTypes.string,\n      yType: React.PropTypes.string,\n      datePattern: React.PropTypes.string,\n      interpolate: React.PropTypes.string,\n      style: React.PropTypes.object,\n      margin: React.PropTypes.object,\n      axes: React.PropTypes.bool,\n      grid: React.PropTypes.bool,\n      verticalGrid: React.PropTypes.bool,\n      xDomainRange: React.PropTypes.array,\n      yDomainRange: React.PropTypes.array,\n      axisLabels: React.PropTypes.object,\n      tickTimeDisplayFormat: React.PropTypes.string,\n      yTicks: React.PropTypes.number,\n      xTicks: React.PropTypes.number,\n      dataPoints: React.PropTypes.bool,\n      lineColors: React.PropTypes.array,\n      yAxisOrientRight: React.PropTypes.bool,\n      mouseOverHandler: React.PropTypes.func,\n      mouseOutHandler: React.PropTypes.func,\n      mouseMoveHandler: React.PropTypes.func,\n      clickHandler: React.PropTypes.func\n    };\n  }\n\n  static get defaultProps() {\n    return {\n      width: 200,\n      height: 150,\n      datePattern: '%d-%b-%y',\n      interpolate: 'linear',\n      axes: false,\n      xType: 'linear',\n      yType: 'linear',\n      lineColors: [],\n      axisLabels: {x: '', y: ''},\n      mouseOverHandler: () => {},\n      mouseOutHandler: () => {},\n      mouseMoveHandler: () => {},\n      clickHandler: () => {}\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.parseDate = format(props.datePattern).parse;\n    this.uid = getRandomId();\n  }\n\n  componentDidMount() {\n    createCircularTicks(this.refs[this.uid]);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.width !== prevProps.width) {\n      createCircularTicks(this.refs[this.uid]);\n    }\n  }\n\n  render() {\n    const {data,\n      xType,\n      yType,\n      style,\n      axes,\n      axisLabels,\n      xDomainRange,\n      yDomainRange,\n      xTicks,\n      yTicks,\n      interpolate,\n      grid,\n      verticalGrid,\n      tickTimeDisplayFormat,\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler,\n      dataPoints,\n      lineColors,\n      yAxisOrientRight} = this.props;\n    const margin = calcMargin(axes, this.props.margin, yAxisOrientRight);\n    const defaultColours = lineColors.concat(rmaColorPalet);\n    const width = reduce(this.props.width, margin.left, margin.right);\n    const height = reduce(this.props.height, margin.top, margin.bottom);\n\n    const x = setLineDomainAndRange('x', xDomainRange, data, xType, width, this.parseDate);\n    const y = setLineDomainAndRange('y', yDomainRange, data, yType, height, this.parseDate);\n\n    const yValue = getValueFunction('y', yType, this.parseDate);\n    const xValue = getValueFunction('x', xType, this.parseDate);\n    const linePath = svg.line().interpolate(interpolate).x((d) => x(xValue(d))).y((d) => y(yValue(d)));\n\n    const svgNode = createElement('svg');\n    select(svgNode).attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom);\n    const root = select(svgNode).append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n    if (axes) {\n      const xAxis = svg.axis().scale(x).orient('bottom');\n      if (xType === 'time' && tickTimeDisplayFormat) {\n        xAxis.tickFormat(time.format(tickTimeDisplayFormat));\n      }\n      if (grid && verticalGrid) { xAxis.tickSize(-height, 6).tickPadding(15); } else { xAxis.tickSize(0).tickPadding(15);}\n      if (xTicks) xAxis.ticks(xTicks);\n      root.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', `translate(0,${height})`)\n        .call(xAxis)\n        .append('text')\n        .attr('class', 'label')\n        .attr('y', margin.bottom - 10)\n        .attr('x', yAxisOrientRight ? 0 : width)\n        .style('text-anchor', yAxisOrientRight ? 'start' : 'end')\n        .text(axisLabels.x);\n\n      const yAxis = svg.axis().scale(y)\n        .orient(yAxisOrientRight ? 'right' : 'left');\n      if (yType === 'time' && tickTimeDisplayFormat) {\n        yAxis.tickFormat(time.format(tickTimeDisplayFormat));\n      }\n      if (grid) { yAxis.tickSize(-width, 6).tickPadding(12); } else { yAxis.tickPadding(10); }\n      if (yTicks) yAxis.ticks(yTicks);\n      root.append('g')\n        .attr('class', 'y axis')\n        .call(yAxis)\n        .attr('transform', yAxisOrientRight ? `translate(${width}, 0)` : `translate(0, 0)`)\n        .append('text')\n        .attr('class', 'label')\n        .attr('transform', 'rotate(-90)')\n        .attr('x', 0)\n        .attr('y', yAxisOrientRight ? -20 + margin.right : 0 - margin.left)\n        .attr('dy', '.9em')\n        .style('text-anchor', 'end')\n        .text(axisLabels.y);\n    }\n\n    data.map((dataElelment, i) => {\n      root.append('path')\n        .datum(dataElelment)\n        .attr('class', `line`)\n        .attr('style', `stroke: ${defaultColours[i]}`)\n        .attr('d', linePath);\n    });\n\n    if (dataPoints) {\n      data.map((dataElelment, i) => {\n        dataElelment.map((dotData) => {\n          root.append('circle')\n          .attr('class', 'data-point')\n          .style('strokeWidth', '2px')\n          .style('stroke', defaultColours[i])\n          .style('fill', 'white')\n          .attr('cx', () => {\n            switch (xType) {\n              case ('time'):\n                return x(this.parseDate(dotData.x));\n              default:\n                return x(dotData.x);\n            }\n          })\n          .attr('cy', () => {\n            switch (yType) {\n              case ('time'):\n                return y(this.parseDate(dotData.y));\n              default:\n                return y(dotData.y);\n            }\n          })\n          .on('mouseover', () => mouseOverHandler(dotData, d3LastEvent))\n          .on('mouseout', () => mouseOutHandler(dotData, d3LastEvent))\n          .on('mousemove', () => mouseMoveHandler(d3LastEvent))\n          .on('click', () => clickHandler(dotData, d3LastEvent));\n        });\n      });\n    }\n\n\n    return (\n      <div ref={this.uid} className={`line-chart${this.uid}`}>\n        <Style scopeSelector={`.line-chart${this.uid}`} rules={merge({}, defaultStyle, style, getAxisStyles(grid, verticalGrid, yAxisOrientRight))}/>\n        {svgNode.toReact()}\n      </div>\n    );\n  }\n}\n"]}